from pwn import *

# 서버 연결
p = remote("upside.chainlight.com", 9999)

# STEP 1: username 입력
p.sendlineafter(b"Please enter your username:", b"Charles")

# STEP 2: instructor key 블럭 끝까지 받아놓기
p.recvuntil(b"-----END PGP PUBLIC KEY BLOCK-----")
p.recvline()  # 블럭 끝난 뒤 개행도 소비

# STEP 3: 내 GPG public key (암호화 + base64 인코딩된 파일)
with open("Charles_pubkey.asc.asc.b64", "rb") as f:
    key_data = f.read().strip()

# base64 key 전송
p.sendline(key_data)
# 입력 종료 알리기 위해 빈 줄 추가
p.sendline(b"")

# STEP 4: GitHub repo URL 전송
repo_url = b"https://github.com/yyxcn/testest"
p.sendlineafter(b"GitHub URL:", repo_url)

# 이후 출력은 직접 확인
p.interactive()